# Configuration for syncing resource types from resource-types-contrib repository
# This file defines which resource types should be automatically synced and registered by default in Radius

# Source repository containing resource type definitions
source:
  repository: radius-project/resource-types-contrib
  branch: main
  # Path in the source repository where resource types are stored
  basePath: resource-types

# Target directory in this repository where synced files will be stored
target:
  # Directory for default resource types that should be registered automatically
  # Using the self-hosted directory which is already configured in UCP
  directory: deploy/manifest/built-in-providers/self-hosted
  
  # Prefix for synced files to distinguish them from manually maintained files
  # Files synced from resource-types-contrib will be prefixed with this
  filePrefix: "synced_"

# Sync configuration
sync:
  # Strategy for syncing files: 'metadata' or 'convention'
  # - metadata: Look for 'defaultRegistration: true' in resource type YAML files
  # - convention: Sync all files in a specific directory (e.g., 'default' subdirectory)
  strategy: metadata
  
  # Field name to check in resource type YAML for default registration flag
  # Only applicable when strategy is 'metadata'
  metadataField: defaultRegistration
  
  # When using 'convention' strategy, specify the subdirectory to sync
  # conventionPath: default

# File patterns to sync (glob patterns)
# Only files matching these patterns will be considered for syncing
filePatterns:
  - "**/*.yaml"
  - "**/*.yml"

# Files to exclude from syncing (glob patterns)
excludePatterns:
  - "**/test/**"
  - "**/testdata/**"
  - "**/*.test.yaml"
  - "**/*.test.yml"

# Validation settings
validation:
  # Ensure synced files follow the proper resource type manifest format
  enabled: true
  
  # Required fields in each resource type manifest
  requiredFields:
    - namespace
    - types

# Pull request settings for sync updates
pullRequest:
  # Whether to create a PR or commit directly
  createPR: true
  
  # Base branch for the PR
  baseBranch: main
  
  # Branch name prefix for sync PRs
  branchPrefix: "sync/resource-types"
  
  # PR title template
  titleTemplate: "Sync resource types from resource-types-contrib"
  
  # PR body template
  bodyTemplate: |
    This PR automatically syncs default resource type definitions from the [resource-types-contrib](https://github.com/radius-project/resource-types-contrib) repository.
    
    ## Changes
    
    The following resource type files have been updated:
    
    {{files}}
    
    ## Verification
    
    - [ ] Resource type manifests follow the proper format
    - [ ] All required fields are present
    - [ ] No sensitive data is included
    
    This PR was automatically generated by the resource type sync workflow.
    
    /cc @radius-project/maintainers
  
  # Labels to apply to sync PRs
  labels:
    - "resource-types"
    - "sync"
    - "automated"
  
  # Reviewers to assign (team or individual users)
  reviewers:
    teams: []
    users: []

# Notification settings
notifications:
  # Notify on sync failures
  onFailure:
    enabled: true
    # Slack webhook URL (stored as GitHub secret)
    # slackWebhook: SLACK_WEBHOOK_URL
  
  # Notify on successful sync with changes
  onSuccess:
    enabled: false
